<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <!-- Required meta tags -->
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Ustudy</title>
    <link rel="stylesheet" href="vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="vendors/owl.carousel/css/owl.carousel.css">
    <link rel="stylesheet" href="vendors/owl.carousel/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="vendors/aos/css/aos.css">
    <link rel="stylesheet" href="vendors/jquery-flipster/css/jquery.flipster.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="shortcut icon" href="images/favicon.png"/>
</head>
<body>
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/home"><img src="images/logo.png" alt="Marshmallow"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"><i class="mdi mdi-menu"> </i></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                <div class="d-lg-none d-flex justify-content-between px-4 py-3 align-items-center">
                    <img src="images/logo-dark.svg" class="logo-mobile-menu" alt="logo">
                    <a href="javascript:;" class="close-menu"><i class="mdi mdi-close"></i></a>
                </div>
                <ul class="navbar-nav ml-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link btn btn-success" href="/home">home</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="page-body-wrapper">
        <section class="request_admin">
            <center><h2>Choose Center</h2></center>
            <div class="container p-3 my-3 border border-primary rounded ">
                <div class="row">
                    <div th:with="request=${req}">
                        <input type="button" name="createRC" id="createRC" value="add center">
                        <input type="hidden" id="reqID" th:value="${request.getRequest_id()}"
                               class="btn btn-primary btn-sm text-white col-sm-5" aria-describedby="basic-addon5"/>
                    </div>
                    <div th:each="reqCent:${rcList}">
                        <div>
                            <select id="c_id" th:id="c_id+${reqCent.getRc()}" name="centers"
                                    onchange='changeCenter()' th:attr="onchange=|changeCenter('${reqCent.getRc()}')|"
                                    class="custom-select" >
                                <option value="none" hidden="">Choose center</option>
                                <option th:each="centerList:${cList}" th:value='${centerList.getCenter_id()}' th:text="${centerList.getRegion()}"></option>
                            </select><br>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon1">Number of Places</span>
                            </div>
                        <input type="text" name="n_o_p" onchange="changeNOP()" th:attr="onchange=|changeNOP('${reqCent.getRc()}')|"
                               th:id="n_o_p+${reqCent.getRc()}" placeholder='num of places' th:value='${reqCent.getNum_of_places()}'
                               class="form-control"  aria-describedby="basic-addon1">
                        </div><br>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon2">Start Date</span>
                            </div>
                        <input type="datetime" name="start" onchange="changeStart()" th:attr="onchange=|changeStart('${reqCent.getRc()}')|"
                               th:id="start+${reqCent.getRc()}" placeholder='start date' th:value='${reqCent.getDates().getStart_date()}'
                               class="form-control"  aria-describedby="basic-addon1">
                        </div><br>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon3">Finish date</span>
                            </div>
                        <input type="datetime" name="finish" onchange="changeFinish()" th:attr="onchange=|changeFinish('${reqCent.getRc()}')|"
                               th:id="finish+${reqCent.getRc()}" placeholder='finish date' th:value='${reqCent.getDates().getFinish_date()}'
                               class="form-control"  aria-describedby="basic-addon1">
                        </div><br>
                    </div>
                    <div id="RC"></div>
                </div>
            </div>
        </section>
    </div>
    <footer class="footer">
        <div class="footer-top">
            <div class="container">
                <div class="row">
                    <div class="col-sm-6">
                        <address>
                            <p>Nur-Sultan, st. Kunaeva 12/1 &nbsp +7 (700) 202-93-24 &nbsp<a href="mailto:info@ustudy.kz" class="footer-link">info@ustudy.kz</a></p>
                            <p>Almaty, st. Al-Farabi Avenue 71 &nbsp+7 700 202 93 02 &nbsp<a href="mailto:almaty@ustudy.kz" class="footer-link">almaty@ustudy.kz</a></p>
                        </address>
                        <div class="social-icons">
                            <h6 class="footer-title font-weight-bold">
                                Social networks
                            </h6>
                            <div class="d-flex">
                                <a href="#"><i class="mdi mdi-youtube"></i></a>
                                <a href="#"><i class="mdi mdi-facebook-box"></i></a>
                                <a href="#"><i class="mdi mdi-twitter"></i></a>
                                <a href="#"><i class="mdi mdi-instagram"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <img src="images/logo.png" alt="logo" class="mr-3">
                        <p class="mb-0 text-small pt-1">Â© 2021 <a href="" class="text-white" target="_blank">AITU</a>. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</body>
<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js'></script>
<script th:inline="javascript">
    $(document).on('click', '#createRC', function () {
        $.ajax({
            url: "/createRequestCenter",
            data: {request_id: document.getElementById('reqID').value},
            type: "POST",
            success: function (data) {
                data = JSON.parse(data);
                console.log("your data: ", data);
                let rc_id = data;

                $("#RC").append(
                    "<div>" +
                    "      <div>\n" +
                    "            <select id=\"c_id" + rc_id + "\" onchange='changeCenter("+ rc_id +")' name=\"centers\" class=\"custom-select\">\n" +
                    "                  <option value=\"none\" hidden=\"\">Choose center</option>\n" +
                    /*[# th:each="centerList:${cList}"]*/
                    "                  <option value='[[${centerList.getCenter_id()}]]' >" + [[${centerList.getRegion()}]] + "</option>\n" +
                    /*[/]*/
                    "            </select>" +
                    "      </div>" +
                    "<div class=\"input-group mb-3\">" +
                    " <div className=\"input-group-prepend\"> " +
                    "   <span className=\"input-group-text\" id=\"basic-addon1\">Number of Places</span> " +
                    " </div>" +
                    "      <input type=\"text\" name=\"n_o_p\" onchange=\"changeNOP("+ rc_id +")\" id=\"n_o_p" + rc_id + "\" placeholder='num of places' class=\"form-control\"  aria-describedby=\"basic-addon1\">" +
                    "</div><br>" +
                    "<div class=\"input-group mb-3\">" +
                    " <div className=\"input-group-prepend\"> " +
                    "   <span className=\"input-group-text\" id=\"basic-addon1\">Start Date</span> " +
                    " </div>" +
                    "      <input type=\"datetime\" name=\"start\" onchange=\"changeStart("+ rc_id +")\" id=\"start" + rc_id + "\" placeholder='start date' class=\"form-control\"  aria-describedby=\"basic-addon1\">" +
                    "</div><br>" +
                    "<div class=\"input-group mb-3\">" +
                    " <div className=\"input-group-prepend\"> " +
                    "   <span className=\"input-group-text\" id=\"basic-addon1\">Finish date</span> " +
                    " </div>" +
                    "      <input type=\"datetime\" name=\"finish\" onchange=\"changeFinish("+ rc_id +")\" id=\"finish" + rc_id + "\" placeholder='finish date' class=\"form-control\"  aria-describedby=\"basic-addon1\">" +
                    "</div><br>" +
                    "</div>"
                )
            }
        })
    })
</script>
<script>
    function changeNOP(rc_id){
        let rcnop = document.getElementById('n_o_p'+rc_id).value;
        $.ajax({
            url: "/updateRCNOP",
            data: {
                rc_id: rc_id,
                n_o_p: rcnop
            },
            type: "POST",
            success: function (data) {
                data = JSON.parse(data);
                console.log("your data: ", data);
            }
        })
    }

    function changeStart(rc_id){
        let rcstart = document.getElementById('start'+rc_id).value;
        $.ajax({
            url: "/updateRCStart",
            data: {
                rc_id: rc_id,
                start: rcstart
            },
            type: "POST",
            success: function (data) {
                data = JSON.parse(data);
                console.log("your data: ", data);
            }
        })
    }

    function changeFinish(rc_id){
        let rcfinish = document.getElementById('finish'+rc_id).value;
        $.ajax({
            url: "/updateRCFinish",
            data: {
                rc_id: rc_id,
                finish: rcfinish
            },
            type: "POST",
            success: function (data) {
                data = JSON.parse(data);
                console.log("your data: ", data);
            }
        })
    }

    function changeCenter(rc_id){
        let rcCenter = document.getElementById('c_id'+rc_id).value;
        $.ajax({
            url: "/updateRCCenter",
            data: {
                rc_id: rc_id,
                c_id: rcCenter
            },
            type: "POST",
            success: function (data) {
                data = JSON.parse(data);
                console.log("your data: ", data);
            }
        })
    }
</script>
<script src="js/index.js"></script>
</html>